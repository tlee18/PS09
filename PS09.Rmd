---
title: "STAT/MATH 495: Problem Set 09"
author: "Tim Lee"
date: "2017-11-07"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    collapsed: false
    smooth_scroll: false
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, fig.width=8, fig.height=4.5, message=FALSE, warning = FALSE
  )
set.seed(76)

library(tidyverse)
```



# Collaboration

Please indicate who you collaborated with on this assignment: Pei Gong, Vickie Ip



# Question 1: Run k-means

```{r}
observations_1 <- read_csv("data/observations_1.csv")
observations_2 <- read_csv("data/observations_2.csv")

# Set observations to be one of two datasets
observations <- observations_2
# n <- 0
# n <- n+1
# Fit model for k=2
k <- 2
k_means_results <- kmeans(observations, centers=k)
clusters <- k_means_results$cluster
cluster_centers <- k_means_results$centers

# Add cluster results to observations. Note we convert to factor since cluster
# ID's should be treated as categorical
observations$cluster <- as.factor(clusters)

# Add cluster ID's to cluster_centers
cluster_centers <- cluster_centers %>% 
  as_tibble() %>% 
  mutate(cluster=as.factor(1:k))

ggplot(NULL, aes(x=x1, y=x2, col=cluster)) +
  geom_point(data=observations) +
  geom_point(data=cluster_centers, size=5) 
# + labs(title = paste0("observations_2 ", n))
```

**Questions**:

1. Run KMC 10 times on `observations_1` and comment on the consistency of the
results.
1. Speculate on the root cause of any consistency or inconsistency in the
results.
1. Run KMC 10 times on `observations_2` and comment on the consistency of the
results.
1. Speculate on the root cause of any consistency or inconsistency in the
results.

**Answers**:

1. For the `observations_1` dataset, the colors change and so do the location of the cluster centers. 

1. The inconsistency in the color is due to the random starting point of the cluster centroids. The inconsistency in the cluster locations is due to the lack of clear clusters. Since the data points are not naturally forming clusters, the fitted model is more dependent on the random starting point and not a clear signal of a relationship. 

1. For the `observations_2` dataset, the colors change though the cluster centers stay in the same place. When I ran KMC 10 times, the "red" cluster appeared in the top-right 5 times, whereas the "blue" cluster appeared in the top-right about 5 times. The color seemed random. 

1. The inconsistency in the color is due to the random placement of the centroids in the beginning the k-means clustering algorithm, which will affect the starting color. The consistency of the cluster centroid locations is due to the clusters being distinct. There are two groups that have strong with-in group similarity and strong between-group distinctness.



# Bonus question: Code your own

Read ISLR page 388 Algorithm 10.1 and implement k-means clustering from scratch.
Don't worry about doing it for general $k$; keep it simple and do it for $k=2$
specifically. Apply it to `observations_2` from above.

```{r}
# Hint:
library(proxy)
A <- data_frame(
  x1 = c(0, 0.5, 0.75, 1),
  x2 = c(0, 0.5, 0.75, 1)
)
B <- data_frame(
  x1 = c(1, 0),
  x2 = c(1, 0)
)
distance_matrix <- proxy::dist(x=A, y=B)
distance_matrix
apply(distance_matrix, 1, which.min)
```
